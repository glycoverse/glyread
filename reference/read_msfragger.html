<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Read MSFragger-Glyco result — read_msfragger • glyread</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Read MSFragger-Glyco result — read_msfragger"><meta name="description" content='MSFragger-Glyco is a software for glycopeptide identification and quantification.
This function reads in the result file and returns a glyexp::experiment() object.
Because MSFragger performs quantification on the PSM level for each sample,
and outputs the result to separate files,
this function cannot read and merge multiple result files into a single glyexp::experiment() object.
See details to understand why.
As a workaround, use this code snippet to read the result into a list of glyexp::experiment()`` objects, aggregate the experiments to the "glycoform" level using glyclean::aggregate(), and then use glyexp::merge()` (need glyexp &amp;gt;= 0.7.0) to merge them into one:
library(tidyverse)
library(glyread)
library(glyclean)
library(glyexp)

# Read the result into a list of experiments
files &amp;lt;- c("psm1.tsv", "psm2.tsv", "psm3.tsv")
exps &amp;lt;- map(files, read_msfragger)  # ignore sample_info for now

# Aggregate the experiments to the "glycoform" level
exps_agg &amp;lt;- map(exps, aggregate, to_level = "gf")  # or other levels

# Merge the experiments into one
exp_merged &amp;lt;- reduce(exps_agg, merge)

# Add sample information
# Say you already have a sample information tibble (`sample_df`) with a "sample" column
exp_merged$sample_info &amp;lt;- exp_merged$sample_info |&amp;gt;
  left_join(sample_df, by = "sample")

Note that we override the sample information with the new one,
which is not a recommended practice.
However, the code here is harmless,
and you can safely use it until we find a better solution.'><meta property="og:description" content='MSFragger-Glyco is a software for glycopeptide identification and quantification.
This function reads in the result file and returns a glyexp::experiment() object.
Because MSFragger performs quantification on the PSM level for each sample,
and outputs the result to separate files,
this function cannot read and merge multiple result files into a single glyexp::experiment() object.
See details to understand why.
As a workaround, use this code snippet to read the result into a list of glyexp::experiment()`` objects, aggregate the experiments to the "glycoform" level using glyclean::aggregate(), and then use glyexp::merge()` (need glyexp &amp;gt;= 0.7.0) to merge them into one:
library(tidyverse)
library(glyread)
library(glyclean)
library(glyexp)

# Read the result into a list of experiments
files &amp;lt;- c("psm1.tsv", "psm2.tsv", "psm3.tsv")
exps &amp;lt;- map(files, read_msfragger)  # ignore sample_info for now

# Aggregate the experiments to the "glycoform" level
exps_agg &amp;lt;- map(exps, aggregate, to_level = "gf")  # or other levels

# Merge the experiments into one
exp_merged &amp;lt;- reduce(exps_agg, merge)

# Add sample information
# Say you already have a sample information tibble (`sample_df`) with a "sample" column
exp_merged$sample_info &amp;lt;- exp_merged$sample_info |&amp;gt;
  left_join(sample_df, by = "sample")

Note that we override the sample information with the new one,
which is not a recommended practice.
However, the code here is harmless,
and you can safely use it until we find a better solution.'><meta property="og:image" content="https://glycoverse.github.io/glyread/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glyread</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Read MSFragger-Glyco result</h1>

      <div class="d-none name"><code>read_msfragger.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>MSFragger-Glyco is a software for glycopeptide identification and quantification.
This function reads in the result file and returns a <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> object.</p>
<p>Because MSFragger performs quantification on the PSM level for each sample,
and outputs the result to separate files,
this function cannot read and merge multiple result files into a single <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> object.
See details to understand why.</p>
<p>As a workaround, use this code snippet to read the result into a list of <code>glyexp::experiment()`` objects, aggregate the experiments to the "glycoform" level using </code>glyclean::aggregate()<code>, and then use </code>glyexp::merge()` (need glyexp &gt;= 0.7.0) to merge them into one:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyread/">glyread</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">glyclean</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyexp/" class="external-link">glyexp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read the result into a list of experiments</span></span>
<span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"psm1.tsv"</span>, <span class="st">"psm2.tsv"</span>, <span class="st">"psm3.tsv"</span><span class="op">)</span></span>
<span><span class="va">exps</span> <span class="op">&lt;-</span> <span class="fu">map</span><span class="op">(</span><span class="va">files</span>, <span class="va">read_msfragger</span><span class="op">)</span>  <span class="co"># ignore sample_info for now</span></span>
<span></span>
<span><span class="co"># Aggregate the experiments to the "glycoform" level</span></span>
<span><span class="va">exps_agg</span> <span class="op">&lt;-</span> <span class="fu">map</span><span class="op">(</span><span class="va">exps</span>, <span class="va">aggregate</span>, to_level <span class="op">=</span> <span class="st">"gf"</span><span class="op">)</span>  <span class="co"># or other levels</span></span>
<span></span>
<span><span class="co"># Merge the experiments into one</span></span>
<span><span class="va">exp_merged</span> <span class="op">&lt;-</span> <span class="fu">reduce</span><span class="op">(</span><span class="va">exps_agg</span>, <span class="va">merge</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add sample information</span></span>
<span><span class="co"># Say you already have a sample information tibble (`sample_df`) with a "sample" column</span></span>
<span><span class="va">exp_merged</span><span class="op">$</span><span class="va">sample_info</span> <span class="op">&lt;-</span> <span class="va">exp_merged</span><span class="op">$</span><span class="va">sample_info</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">sample_df</span>, by <span class="op">=</span> <span class="st">"sample"</span><span class="op">)</span></span></code></pre><p></p></div>
<p>Note that we override the sample information with the new one,
which is not a recommended practice.
However, the code here is harmless,
and you can safely use it until we find a better solution.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read_msfragger</span><span class="op">(</span></span>
<span>  <span class="va">fp</span>,</span>
<span>  sample_info <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quant_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"label-free"</span>, <span class="st">"TMT"</span><span class="op">)</span>,</span>
<span>  glycan_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="st">"O"</span><span class="op">)</span>,</span>
<span>  sample_name_converter <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fp">fp<a class="anchor" aria-label="anchor" href="#arg-fp"></a></dt>
<dd><p>File path of the MSFragger result file.</p></dd>


<dt id="arg-sample-info">sample_info<a class="anchor" aria-label="anchor" href="#arg-sample-info"></a></dt>
<dd><p>File path of the sample information file (csv),
or a sample information data.frame/tibble.</p></dd>


<dt id="arg-quant-method">quant_method<a class="anchor" aria-label="anchor" href="#arg-quant-method"></a></dt>
<dd><p>Quantification method. Either "label-free" or "TMT".</p></dd>


<dt id="arg-glycan-type">glycan_type<a class="anchor" aria-label="anchor" href="#arg-glycan-type"></a></dt>
<dd><p>Glycan type. Either "N" or "O". Default is "N".</p></dd>


<dt id="arg-sample-name-converter">sample_name_converter<a class="anchor" aria-label="anchor" href="#arg-sample-name-converter"></a></dt>
<dd><p>A function to convert sample names from file paths.
The function should take a character vector of old sample names
and return new sample names.
Note that sample names in <code>sample_info</code> should match the new names.
If NULL, original names are kept.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="why-not-read-multiple-files-">Why not read multiple files?<a class="anchor" aria-label="anchor" href="#why-not-read-multiple-files-"></a></h2>
    <p>This is the first solution we thought of.
However, we found it is not compatible with the current design of <code>glycoverse</code> settings.
MSFragger-Glyco results are on the PSM level,
each raw sample resulting in a separate file.
To merge them into one expression matrix, with rows as PSMs and columns as samples,
we need to identify the PSM that appears in different samples.
This is not trivial, as an ion (with the same charge and modification state)
can generate multiple PSMs with different retention time and m/z.</p>
<p>One possible solution is to aggregate each PSM result into a glycoform level.
That is, for a glycoform (unique combination of glycan, protein, and glycosite),
we sum up the quantifications of all PSMs that belong to this glycoform.
Then the data can be merged into one expression matrix,
with rows as glycoforms and columns as samples.
This is exactly what the about code snippet does.</p>
<p>So why not just incorporate this approach into <code>glyread</code>?
Well, the job of <code>glyread</code> should be to read search results as they are.
It should not be responsible for any data preprocessing.
Aggregating data into "glycoform" level is a preprocessing step.
In fact, it is not even the first step
(aggregation after normalization and imputation is more preferred).
So we put this function in the <code>glyclean</code> package.</p>
<p>Maybe in the future, MSFragger-Glyco has a merged output like pGlycoQuant.
Then everyone is happy.
But for now, we leave this to the user to do.
Hint: you can wrap the snippet above into a function yourself.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code>, <code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_composition.html" class="external-link">glyrepr::glycan_composition()</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

